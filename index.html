Transaction(${transaction.id})">x</button>
                `;
                transactionList.appendChild(item);
            }

            function updateBalances() {
                const income = transactions
                    .filter(transaction => transaction.type === 'income')
                    .reduce((sum, transaction) => sum + transaction.amount, 0);
                
                const expense = transactions
                    .filter(transaction => transaction.type === 'expense')
                    .reduce((sum, transaction) => sum + transaction.amount, 0);

                const total = income - expense;

                balanceTotal.innerText = `Rp ${total}`;
                balanceCash.innerText = `Rp ${calculateBalance('cash')}`;
                balanceBank.innerText = `Rp ${calculateBalance('bank')}`;
                balanceDana.innerText = `Rp ${calculateBalance('dana')}`;
                balanceShopee.innerText = `Rp ${calculateBalance('shopee')}`;
                balanceGoPay.innerText = `Rp ${calculateBalance('gopay')}`;
            }

            function calculateBalance(account) {
                const income = transactions
                    .filter(transaction => transaction.type === 'income' && transaction.account === account)
                    .reduce((sum, transaction) => sum + transaction.amount, 0);
                
                const expense = transactions
                    .filter(transaction => transaction.type === 'expense' && transaction.account === account)
                    .reduce((sum, transaction) => sum + transaction.amount, 0);

                return income - expense;
            }

            function removeTransaction(id) {
                transactions = transactions.filter(transaction => transaction.id !== id);
                updateLocalStorage();
                init();
            }

            function updateLocalStorage() {
                localStorage.setItem('transactions', JSON.stringify(transactions));
            }

            function init() {
                transactionList.innerHTML = '';
                transactions.forEach(addTransactionDOM);
                updateBalances();
            }

            function addNewAccount() {
                const newAccount = prompt("Masukkan nama jalur transaksi baru:");
                if (newAccount && !accounts.includes(newAccount)) {
                    accounts.push(newAccount);
                    updateAccountSelect();
                    updateLocalStorageAccounts();
                }
            }

            function updateAccountSelect() {
                accountSelect.innerHTML = accounts
                    .map(account => `<option value="${account}">${account.charAt(0).toUpperCase() + account.slice(1)}</option>`)
                    .join('');
            }

            function updateLocalStorageAccounts() {
                localStorage.setItem('accounts', JSON.stringify(accounts));
            }

            addAccountBtn.addEventListener('click', addNewAccount);

            // Searching for transactions
            searchInput.addEventListener('input', () => {
                const query = searchInput.value.toLowerCase();
                const filteredTransactions = transactions.filter(transaction =>
                    transaction.comment.toLowerCase().includes(query) ||
                    transaction.account.toLowerCase().includes(query) ||
                    transaction.date.includes(query)
                );
                transactionList.innerHTML = '';
                filteredTransactions.forEach(addTransactionDOM);
            });

            // Scroll up and down buttons
            scrollUpBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            scrollDownBtn.addEventListener('click', () => {
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            });

            init();
            updateAccountSelect();
        });

        function removeTransaction(id) {
            const confirmation = confirm('Apakah Anda yakin ingin menghapus transaksi ini?');
            if (confirmation) {
                const transactionIndex = transactions.findIndex(transaction => transaction.id === id);
                transactions.splice(transactionIndex, 1);
                updateLocalStorage();
                init();
            }
        }
    </script>
</body>
</html>
